{"ast":null,"code":"!function (e, t) {\n  \"object\" == typeof exports && \"object\" == typeof module ? module.exports = t(require(\"prop-types\"), require(\"react\")) : \"function\" == typeof define && define.amd ? define([,], t) : \"object\" == typeof exports ? exports.ReactMic = t(require(\"prop-types\"), require(\"react\")) : e.ReactMic = t(e.PropTypes, e.React);\n}(window, function (e, t) {\n  return function (e) {\n    var t = {};\n\n    function n(r) {\n      if (t[r]) return t[r].exports;\n      var o = t[r] = {\n        i: r,\n        l: !1,\n        exports: {}\n      };\n      return e[r].call(o.exports, o, o.exports, n), o.l = !0, o.exports;\n    }\n\n    return n.m = e, n.c = t, n.d = function (e, t, r) {\n      n.o(e, t) || Object.defineProperty(e, t, {\n        enumerable: !0,\n        get: r\n      });\n    }, n.r = function (e) {\n      \"undefined\" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {\n        value: \"Module\"\n      }), Object.defineProperty(e, \"__esModule\", {\n        value: !0\n      });\n    }, n.t = function (e, t) {\n      if (1 & t && (e = n(e)), 8 & t) return e;\n      if (4 & t && \"object\" == typeof e && e && e.__esModule) return e;\n      var r = Object.create(null);\n      if (n.r(r), Object.defineProperty(r, \"default\", {\n        enumerable: !0,\n        value: e\n      }), 2 & t && \"string\" != typeof e) for (var o in e) {\n        n.d(r, o, function (t) {\n          return e[t];\n        }.bind(null, o));\n      }\n      return r;\n    }, n.n = function (e) {\n      var t = e && e.__esModule ? function () {\n        return e.default;\n      } : function () {\n        return e;\n      };\n      return n.d(t, \"a\", t), t;\n    }, n.o = function (e, t) {\n      return Object.prototype.hasOwnProperty.call(e, t);\n    }, n.p = \"\", n(n.s = 2);\n  }([function (t, n) {\n    t.exports = e;\n  }, function (e, n) {\n    e.exports = t;\n  }, function (e, t, n) {\n    e.exports = n(3);\n  }, function (e, t, n) {\n    \"use strict\";\n\n    n.r(t);\n    var r,\n        o,\n        i,\n        a = n(1),\n        c = n.n(a),\n        u = n(0),\n        s = new (window.AudioContext || window.webkitAudioContext)(),\n        l = s.createAnalyser(),\n        f = {\n      getAudioContext: function getAudioContext() {\n        return s;\n      },\n      getAnalyser: function getAnalyser() {\n        return l;\n      },\n      resetAnalyser: function resetAnalyser() {\n        l = s.createAnalyser();\n      },\n      decodeAudioData: function decodeAudioData() {\n        s.decodeAudioData(audioData).then(function (e) {});\n      }\n    };\n\n    function p(e, t) {\n      for (var n = 0; n < t.length; n++) {\n        var r = t[n];\n        r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n      }\n    }\n\n    var d,\n        v,\n        y,\n        h,\n        b,\n        g,\n        m,\n        S,\n        w = [];\n    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;\n\n    var C,\n        R = function () {\n      function e(t, n, a, c, u, s) {\n        var l,\n            p,\n            C,\n            R = this;\n        !function (e, t) {\n          if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n        }(this, e), C = function C() {\n          if (d = Date.now(), i) {\n            if (o && \"suspended\" === o.state && o.resume(), i && \"paused\" === i.state) return void i.resume();\n            o && i && \"inactive\" === i.state && (i.start(10), o.createMediaStreamSource(v).connect(r), h && h());\n          } else navigator.mediaDevices ? (console.log(\"getUserMedia supported.\"), navigator.mediaDevices.getUserMedia(S).then(function (e) {\n            v = e, i = MediaRecorder.isTypeSupported(y.mimeType) ? new MediaRecorder(e, y) : new MediaRecorder(e), h && h(), i.onstop = R.onStop, i.ondataavailable = function (e) {\n              w.push(e.data), m && m(e.data);\n            }, (o = f.getAudioContext()).resume().then(function () {\n              r = f.getAnalyser(), i.start(10), o.createMediaStreamSource(v).connect(r);\n            });\n          })) : alert(\"Your browser does not support audio recording\");\n        }, (p = \"startRecording\") in (l = this) ? Object.defineProperty(l, p, {\n          value: C,\n          enumerable: !0,\n          configurable: !0,\n          writable: !0\n        }) : l[p] = C;\n        var A = s.echoCancellation,\n            x = s.autoGainControl,\n            M = s.noiseSuppression,\n            P = s.channelCount;\n        h = t, b = n, g = a, m = c, y = u, S = {\n          audio: {\n            echoCancellation: A,\n            autoGainControl: x,\n            noiseSuppression: M,\n            channelCount: P\n          },\n          video: !1\n        };\n      }\n\n      var t, n, a;\n      return t = e, (n = [{\n        key: \"stopRecording\",\n        value: function value() {\n          i && \"inactive\" !== i.state && (i.stop(), v.getAudioTracks().forEach(function (e) {\n            e.stop();\n          }), i = null, f.resetAnalyser());\n        }\n      }, {\n        key: \"onStop\",\n        value: function value() {\n          var e = new Blob(w, {\n            type: y.mimeType\n          });\n          w = [];\n          var t = {\n            blob: e,\n            startTime: d,\n            stopTime: Date.now(),\n            options: y,\n            blobURL: window.URL.createObjectURL(e)\n          };\n          b && b(t), g && g(t);\n        }\n      }]) && p(t.prototype, n), a && p(t, a), e;\n    }(),\n        A = {\n      create: function create(e) {\n        var t = f.getAudioContext(),\n            n = f.getAnalyser();\n\n        if (void 0 === C) {\n          var r = t.createMediaElementSource(e);\n          r.connect(n), C = r;\n        }\n\n        n.connect(t.destination);\n      }\n    },\n        x = {\n      visualizeSineWave: function visualizeSineWave(e, t, n, r, o, i) {\n        var a = f.getAnalyser(),\n            c = a.fftSize,\n            u = new Uint8Array(c);\n        e.clearRect(0, 0, n, r), function s() {\n          requestAnimationFrame(s), (a = f.getAnalyser()).getByteTimeDomainData(u), e.fillStyle = o, e.fillRect(0, 0, n, r), e.lineWidth = 2, e.strokeStyle = i, e.beginPath();\n\n          for (var l = 1 * n / c, p = 0, d = 0; d < c; d++) {\n            var v = u[d] / 128 * r / 2;\n            0 === d ? e.moveTo(p, v) : e.lineTo(p, v), p += l;\n          }\n\n          e.lineTo(t.width, t.height / 2), e.stroke();\n        }();\n      },\n      visualizeFrequencyBars: function visualizeFrequencyBars(e, t, n, r, o, i) {\n        var a = this,\n            c = f.getAnalyser();\n        c.fftSize = 256;\n        var u = c.frequencyBinCount,\n            s = new Uint8Array(u);\n        e.clearRect(0, 0, n, r), function t() {\n          requestAnimationFrame(t), (c = f.getAnalyser()).getByteFrequencyData(s), e.fillStyle = o, e.fillRect(0, 0, n, r);\n\n          for (var l, p = n / u * 2.5, d = 0, v = 0; v < u; v++) {\n            l = s[v];\n            a.hexToRgb(i);\n            e.fillStyle = i, e.fillRect(d, r - l / 2, p, l / 2), d += p + 1;\n          }\n        }();\n      },\n      visualizeFrequencyCircles: function visualizeFrequencyCircles(e, t, n, r, o, i) {\n        var a = f.getAnalyser();\n        a.fftSize = 32;\n        var c = a.frequencyBinCount,\n            u = new Uint8Array(c);\n        e.clearRect(0, 0, n, r), function t() {\n          requestAnimationFrame(t), (a = f.getAnalyser()).getByteFrequencyData(u);\n\n          for (var s = new Uint8Array(c / 3), l = 0; l < c; l += 3) {\n            for (var p = 0, d = 0; d < 3; d++) {\n              p += u[l + d];\n            }\n\n            s[l / 3] = p / 3;\n          }\n\n          e.clearRect(0, 0, n, r), e.beginPath(), e.arc(n / 2, r / 2, Math.min(r, n) / 2, 0, 2 * Math.PI), e.fillStyle = o, e.fill();\n          var v = Math.min(r, n) / 2 / s.length;\n          e.strokeStyle = i;\n\n          for (var y = 0; y < s.length; y++) {\n            e.beginPath();\n            var h = v * y + v * (s[y] / 128);\n            e.arc(n / 2, r / 2, h, 0, 2 * Math.PI), e.stroke();\n          }\n        }();\n      },\n      hexToRgb: function hexToRgb(e) {\n        var t = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(e);\n        return t ? {\n          r: parseInt(t[1], 16),\n          g: parseInt(t[2], 16),\n          b: parseInt(t[3], 16)\n        } : null;\n      }\n    };\n\n    function M(e) {\n      return (M = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n        return typeof e;\n      } : function (e) {\n        return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n      })(e);\n    }\n\n    function P(e, t) {\n      for (var n = 0; n < t.length; n++) {\n        var r = t[n];\n        r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n      }\n    }\n\n    function T(e) {\n      return (T = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {\n        return e.__proto__ || Object.getPrototypeOf(e);\n      })(e);\n    }\n\n    function j(e) {\n      if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n      return e;\n    }\n\n    function k(e, t) {\n      return (k = Object.setPrototypeOf || function (e, t) {\n        return e.__proto__ = t, e;\n      })(e, t);\n    }\n\n    var O = function (e) {\n      function t(e) {\n        var n, r, o, i, a, u;\n        return function (e, t) {\n          if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n        }(this, t), r = this, o = T(t).call(this, e), n = !o || \"object\" !== M(o) && \"function\" != typeof o ? j(r) : o, i = j(n), u = function u() {\n          var e = n.props,\n              t = e.backgroundColor,\n              r = e.strokeColor,\n              o = e.width,\n              i = e.height,\n              a = e.visualSetting,\n              c = n.state,\n              u = c.canvas,\n              s = c.canvasCtx;\n          \"sinewave\" === a ? x.visualizeSineWave(s, u, o, i, t, r) : \"frequencyBars\" === a ? x.visualizeFrequencyBars(s, u, o, i, t, r) : \"frequencyCircles\" === a && x.visualizeFrequencyCircles(s, u, o, i, t, r);\n        }, (a = \"visualize\") in i ? Object.defineProperty(i, a, {\n          value: u,\n          enumerable: !0,\n          configurable: !0,\n          writable: !0\n        }) : i[a] = u, n.visualizerRef = c.a.createRef(), n.state = {\n          microphoneRecorder: null,\n          canvas: null,\n          canvasCtx: null\n        }, n;\n      }\n\n      var n, r, o;\n      return function (e, t) {\n        if (\"function\" != typeof t && null !== t) throw new TypeError(\"Super expression must either be null or a function\");\n        e.prototype = Object.create(t && t.prototype, {\n          constructor: {\n            value: e,\n            writable: !0,\n            configurable: !0\n          }\n        }), t && k(e, t);\n      }(t, e), n = t, (r = [{\n        key: \"componentDidUpdate\",\n        value: function value(e) {\n          var t = this.props,\n              n = t.record,\n              r = t.onStop,\n              o = this.state.microphoneRecorder;\n          e.record !== n && (n ? o && o.startRecording() : o && (o.stopRecording(r), this.clear()));\n        }\n      }, {\n        key: \"componentDidMount\",\n        value: function value() {\n          var e = this,\n              t = this.props,\n              n = t.onSave,\n              r = t.onStop,\n              o = t.onStart,\n              i = t.onData,\n              a = t.audioElem,\n              c = t.audioBitsPerSecond,\n              u = t.echoCancellation,\n              s = t.autoGainControl,\n              l = t.noiseSuppression,\n              f = (t.channelCount, t.mimeType),\n              p = this.visualizerRef.current,\n              d = p.getContext(\"2d\"),\n              v = {\n            audioBitsPerSecond: c,\n            mimeType: f\n          },\n              y = {\n            echoCancellation: u,\n            autoGainControl: s,\n            noiseSuppression: l\n          };\n          a ? (A.create(a), this.setState({\n            canvas: p,\n            canvasCtx: d\n          }, function () {\n            e.visualize();\n          })) : this.setState({\n            microphoneRecorder: new R(o, r, n, i, v, y),\n            canvas: p,\n            canvasCtx: d\n          }, function () {\n            e.visualize();\n          });\n        }\n      }, {\n        key: \"clear\",\n        value: function value() {\n          var e = this.props,\n              t = e.width,\n              n = e.height;\n          this.state.canvasCtx.clearRect(0, 0, t, n);\n        }\n      }, {\n        key: \"render\",\n        value: function value() {\n          var e = this.props,\n              t = e.width,\n              n = e.height;\n          return c.a.createElement(\"canvas\", {\n            ref: this.visualizerRef,\n            height: n,\n            width: t,\n            className: this.props.className\n          });\n        }\n      }]) && P(n.prototype, r), o && P(n, o), t;\n    }(a.Component);\n\n    O.propTypes = {\n      backgroundColor: u.string,\n      strokeColor: u.string,\n      className: u.string,\n      audioBitsPerSecond: u.number,\n      mimeType: u.string,\n      height: u.number,\n      record: u.bool.isRequired,\n      onStop: u.func,\n      onData: u.func,\n      onSave: u.func\n    }, O.defaultProps = {\n      backgroundColor: \"rgba(255, 255, 255, 0.5)\",\n      strokeColor: \"#000000\",\n      className: \"visualizer\",\n      audioBitsPerSecond: 128e3,\n      mimeType: \"audio/webm;codecs=opus\",\n      record: !1,\n      width: 640,\n      height: 100,\n      visualSetting: \"sinewave\",\n      echoCancellation: !1,\n      autoGainControl: !1,\n      noiseSuppression: !1,\n      channelCount: 2\n    }, n.d(t, \"ReactMic\", function () {\n      return O;\n    });\n  }]);\n});","map":null,"metadata":{},"sourceType":"script"}